
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<html xmlns="http://www.w3.org/1999/xhtml" lang="es">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <title>6. La librería con la lógica &#8212; documentación de gvSIG Docs - 1.0.0</title>
    <link rel="stylesheet" href="../../../_static/classic.css" type="text/css" />
    <link rel="stylesheet" href="../../../_static/pygments.css" type="text/css" />
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '../../../',
        VERSION:     '1.0.0',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true,
        SOURCELINK_SUFFIX: '.txt'
      };
    </script>
    <script type="text/javascript" src="../../../_static/jquery.js"></script>
    <script type="text/javascript" src="../../../_static/underscore.js"></script>
    <script type="text/javascript" src="../../../_static/doctools.js"></script>
    <script type="text/javascript" src="../../../_static/translations.js"></script>
    <script type="text/javascript" src="../../../_static/sidebar.js"></script>
    <link rel="shortcut icon" href="../../../_static/gvSIG.ico"/>
    <link rel="index" title="Índice" href="../../../genindex.html" />
    <link rel="search" title="Búsqueda" href="../../../search.html" />
    <link rel="next" title="7. La librería con la presentación" href="07_the_library_containing_the_user_interface.html" />
    <link rel="prev" title="5. Las dependencias en los distintos proyectos" href="05_the_project_dependencies.html" /> 
  </head>
  <body>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navegación</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../../../genindex.html" title="Índice General"
             accesskey="I">índice</a></li>
        <li class="right" >
          <a href="07_the_library_containing_the_user_interface.html" title="7. La librería con la presentación"
             accesskey="N">siguiente</a> |</li>
        <li class="right" >
          <a href="05_the_project_dependencies.html" title="5. Las dependencias en los distintos proyectos"
             accesskey="P">anterior</a> |</li>
        <li class="nav-item nav-item-0"><a href="../../../index.html">documentación de gvSIG Docs - 1.0.0</a> &#187;</li>
          <li class="nav-item nav-item-1"><a href="../index.html" >gvSIG 2.3.1. Guía de inicio rápido para el desarrollador</a> &#187;</li>
          <li class="nav-item nav-item-2"><a href="00_index.html" accesskey="U">Construyendo nuestro primer plugin</a> &#187;</li>

<div align="right">
<li>
<a href="http://downloads.gvsig.org/download/web/es/build/html/index.html"><img src="http://downloads.gvsig.org/download/web/pt_br/build/html/_static/flag_ES.png"></a></li>
<a href="http://downloads.gvsig.org/download/web/en/build/html/index.html"><img src="http://downloads.gvsig.org/download/web/pt_br/build/html/_static/flag_EN.png"></a></li>
<a href="http://downloads.gvsig.org/download/web/pt_br/build/html/index.html"><img src="http://downloads.gvsig.org/download/web/pt_br/build/html/_static/flag_BR.png"></a></li>
</div>

      </ul>
    </div>  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <div class="section" id="la-libreria-con-la-logica">
<h1>6. La librería con la lógica<a class="headerlink" href="#la-libreria-con-la-logica" title="Enlazar permanentemente con este título">¶</a></h1>
<p>La parte de la lógica de nuestro desarrollo la encontraremos dividida en dos proyectos:</p>
<ul class="simple">
<li>org.gvsig.landregistryviewer.lib.api</li>
<li>org.gvsig.landregistryviewer.lib.impl</li>
</ul>
<p>En el proyecto del API encontraremos principalmente interfaces. Estos interfaces compondrán
el API de los componentes de lógica que precisemos desarrollar.
EL modelo de clases del ejemplo es el que se muestra en el siguiente diagrama:</p>
<div class="figure align-center" id="id1">
<img alt="../../../_images/org.gvsig.visor.api1.png" src="../../../_images/org.gvsig.visor.api1.png" />
<p class="caption"><span class="caption-text">Modelo de clases del API</span></p>
</div>
<p>Tendremos las siguientes entidades:</p>
<ul>
<li><p class="first"><strong>LandregistryviewerLibrary</strong>, que representa al objeto <em>Library</em>. De esta clase señalar los métodos:</p>
<ul>
<li><p class="first"><em>doRegistration</em>, que se ejecuta al cargar la librería e informa qué clase de librería
es, en nuestro caso la definición de un API, así como qué otras librerías requiere que estén
inicializadas antes que esta, la librería de acceso a datos, y la de geometrías. El código
que hace esto es:</p>
<div class="highlight-java"><div class="highlight"><pre><span></span><span class="kd">public</span> <span class="kt">void</span> <span class="nf">doRegistration</span><span class="o">()</span> <span class="o">{</span>
  <span class="k">this</span><span class="o">.</span><span class="na">registerAs</span><span class="o">(</span><span class="n">landregistryviewerLibrary</span><span class="o">.</span><span class="na">class</span><span class="o">,</span> <span class="n">Library</span><span class="o">.</span><span class="na">TYPE</span><span class="o">.</span><span class="na">API</span><span class="o">);</span>
  <span class="k">this</span><span class="o">.</span><span class="na">require</span><span class="o">(</span><span class="n">DALLibrary</span><span class="o">.</span><span class="na">class</span><span class="o">);</span>
  <span class="k">this</span><span class="o">.</span><span class="na">require</span><span class="o">(</span><span class="n">GeometryLibrary</span><span class="o">.</span><span class="na">class</span><span class="o">);</span>
<span class="o">}</span>
</pre></div>
</div>
</li>
<li><p class="first"><em>doPostInitialize</em>, que se ejecuta cuando se han inicializado todas las librerías.
En nuestro caso realiza comprobaciones para verificar que al menos una implementación
del API ha sido registrada. El código que hace esto es:</p>
<div class="highlight-java"><div class="highlight"><pre><span></span><span class="kd">protected</span> <span class="kt">void</span> <span class="nf">doPostInitialize</span><span class="o">()</span> <span class="kd">throws</span> <span class="n">LibraryException</span> <span class="o">{</span>
  <span class="c1">// Validate if there are any implementation registered.</span>
  <span class="n">landregistryviewerManager</span> <span class="n">manager</span> <span class="o">=</span> <span class="n">LandregistryviewerLocator</span><span class="o">.</span><span class="na">getManager</span><span class="o">();</span>
  <span class="k">if</span> <span class="o">(</span><span class="n">manager</span> <span class="o">==</span> <span class="kc">null</span><span class="o">)</span> <span class="o">{</span>
      <span class="k">throw</span> <span class="k">new</span> <span class="n">ReferenceNotRegisteredException</span><span class="o">(</span>
          <span class="n">LandregistryviewerLocator</span><span class="o">.</span><span class="na">MANAGER_NAME</span><span class="o">,</span> <span class="n">LandregistryviewerLocator</span><span class="o">.</span><span class="na">getInstance</span><span class="o">()</span>
        <span class="o">);</span>
  <span class="o">}</span>
<span class="o">}</span>
</pre></div>
</div>
</li>
</ul>
<p>Esta clase debera ir acompañada del fichero:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">src</span><span class="o">/</span><span class="n">main</span><span class="o">/</span><span class="n">resources</span><span class="o">/</span><span class="n">META</span><span class="o">-</span><span class="n">INF</span><span class="o">/</span><span class="n">services</span><span class="o">/</span><span class="n">org</span><span class="o">.</span><span class="n">gvsig</span><span class="o">.</span><span class="n">tools</span><span class="o">.</span><span class="n">library</span><span class="o">.</span><span class="n">Library</span>
</pre></div>
</div>
<p>En donde exista una linea con el nombre completo (nombre y paquete) de la clase.
Esto es usado por el mecanismo de inicialización de librerias de gvSIG para localizar que
clases <em>«library»</em> deben ser cargadas e inicializadas al inicio de la aplicación.</p>
<p>Si ha de cambiar el nombre a la clase <em>LandregistryviewerLibrary</em> recuerde editar este fichero
para cambiarlo en el tambien ya que el IDE no lo hara por usted.</p>
</li>
<li><p class="first"><strong>landregistryviewerLocator</strong>, es el <em>locator</em> de nuestra librería, el encargado de
suministrarnos la instancia de nuestro manager. Se trata de una clase con métodos
estáticos para registrar implementaciones de este API u obtener una implementación
de él.</p>
</li>
<li><p class="first"><strong>landregistryviewerManager</strong>. Un interface. El del manager de la librería. Define métodos para obtener las
manzanas y parcelas así como para localizar una manzana dado un punto. Es la
entrada a las distintas entidades de nuestro modelo.</p>
</li>
<li><p class="first"><strong>landregistryviewerBlock</strong>. Un interface que representa a una manzana, y aporta métodos para obtener la geometría
que define la manzana o para obtener las parcelas que la constituyen.</p>
</li>
<li><p class="first"><strong>landregistryviewerProperty</strong>. Un interface que representa una parcela catastral. Tiene métodos para obtener
la geometría que la define, su código o municipio.</p>
</li>
</ul>
<p>Vamos a ver qué nos encontramos en la parte de implementación. Observaremos que
mientras que en el API lo normal ha sido encontrarnos interfaces, en la implementación
nos encontraremos clases. Clases que implementan los distintos interfaces que se
definieron en el API.  Por convenio, a la implementación de los distintos interfaces
que aparecen en el API las llamaremos igual que en el API anteponiéndole el prefijo <em>Default</em>.</p>
<p>El modelo de clases de la implementación para nuestro ejemplo es:</p>
<div class="figure align-center" id="id2">
<img alt="../../../_images/org.gvsig.visor.impl1.png" src="../../../_images/org.gvsig.visor.impl1.png" />
<p class="caption"><span class="caption-text">Modelo de clases de la implementación</span></p>
</div>
<p>Vamos a ir viendo las partes más relevantes de la implementación.</p>
<ul>
<li><p class="first"><strong>LandregistryviewerDefaultImplLibrary</strong>. Al igual que en el API, esta clase se encarga de
inicializar la librería de la implementación. De esta clase señalar los métodos:</p>
<ul>
<li><p class="first"><em>doRegistration</em>, que se encarga de registrar la librería como una implementación
del API de <em>landregistryviewerLibrary</em>. Si tuviese otras dependencias distintas de las marcadas en el
API, se añadirían aquí para asegurarnos que esas librerías se inicializan antes
que esta, pero no es el caso de nuestro ejemplo. Al registrar esta librería como
una implementación de <em>landregistryviewerLibrary</em>, se cubren dos funciones. Por un lado la librería
del API será inicializada siempre antes que esta implementación, y por otro lado
cuando alguna otra librería fije dependencias con el API, el mecanismo de inicialización
de librerías se encargará de inicializar la implementación junto con el API para
asegurarnos de que dispondremos de una implementación del API que hemos requerido.
El código que necesitaremos poner en nuestro ejemplo será:</p>
<div class="highlight-java"><div class="highlight"><pre><span></span><span class="kd">public</span> <span class="kt">void</span> <span class="nf">doRegistration</span><span class="o">()</span> <span class="o">{</span>
  <span class="k">this</span><span class="o">.</span><span class="na">registerAsImplementationOf</span><span class="o">(</span><span class="n">LandregistryviewerLibrary</span><span class="o">.</span><span class="na">class</span><span class="o">);</span>
<span class="o">}</span>
</pre></div>
</div>
</li>
<li><p class="first"><em>doInitialize</em>, que se encarga de registrar en el locator del API la implementación
del manager que tenemos en esta librería. El código que hace esto es:</p>
<div class="highlight-java"><div class="highlight"><pre><span></span><span class="kd">protected</span> <span class="kt">void</span> <span class="nf">doInitialize</span><span class="o">()</span> <span class="kd">throws</span> <span class="n">LibraryException</span> <span class="o">{</span>
    <span class="n">VisorLocator</span><span class="o">.</span><span class="na">registerManager</span><span class="o">(</span><span class="n">DefaultlandregistryviewerManager</span><span class="o">.</span><span class="na">class</span><span class="o">);</span>
<span class="o">}</span>
</pre></div>
</div>
</li>
</ul>
</li>
<li><p class="first"><strong>DefaultlandregistryviewerManager</strong>. De esta clase conviene resaltar principalmente:</p>
<ul>
<li><p class="first">El método <em>getBlock</em>. Podemos ver cómo realizar una busqueda de un registro
filtrando por una condición espacial:</p>
<div class="highlight-java"><div class="highlight"><pre><span></span><span class="k">try</span> <span class="o">{</span>
  <span class="n">String</span> <span class="n">attrGeomName</span> <span class="o">=</span> <span class="n">blocks</span><span class="o">.</span><span class="na">getDefaultFeatureType</span><span class="o">().</span><span class="na">getDefaultGeometryAttributeName</span><span class="o">();</span>
  <span class="n">FeatureQuery</span> <span class="n">query</span> <span class="o">=</span> <span class="n">blocks</span><span class="o">.</span><span class="na">createFeatureQuery</span><span class="o">();</span>
  <span class="n">query</span><span class="o">.</span><span class="na">setFilter</span><span class="o">(</span> <span class="k">new</span> <span class="n">IntersectsEvaluator</span><span class="o">(</span><span class="n">attrGeomName</span><span class="o">,</span><span class="n">point</span><span class="o">)</span> <span class="o">);</span>
  <span class="n">set</span> <span class="o">=</span> <span class="n">blocks</span><span class="o">.</span><span class="na">getFeatureSet</span><span class="o">(</span><span class="n">query</span><span class="o">);</span>
  <span class="k">if</span><span class="o">(</span> <span class="n">set</span><span class="o">.</span><span class="na">isEmpty</span><span class="o">()</span> <span class="o">)</span> <span class="o">{</span>
    <span class="k">return</span> <span class="kc">null</span><span class="o">;</span>
  <span class="o">}</span>
  <span class="n">it</span> <span class="o">=</span> <span class="n">set</span><span class="o">.</span><span class="na">fastiterator</span><span class="o">();</span>
  <span class="n">Feature</span> <span class="n">f</span> <span class="o">=</span> <span class="o">(</span><span class="n">Feature</span><span class="o">)</span> <span class="n">it</span><span class="o">.</span><span class="na">next</span><span class="o">();</span>
  <span class="n">LandregistryviewerBlock</span> <span class="n">block</span> <span class="o">=</span> <span class="k">new</span> <span class="n">DefaultLandregistryviewerBlock</span><span class="o">(</span><span class="k">this</span><span class="o">,</span><span class="n">f</span><span class="o">.</span><span class="na">getGeometry</span><span class="o">(</span><span class="n">attrGeomName</span><span class="o">));</span>
  <span class="k">return</span> <span class="n">block</span><span class="o">;</span>
<span class="o">}</span> <span class="k">catch</span> <span class="o">(</span><span class="n">DataException</span> <span class="n">e</span><span class="o">)</span> <span class="o">{</span>
  <span class="o">...</span>
<span class="o">}</span> <span class="k">finally</span> <span class="o">{</span>
  <span class="k">if</span><span class="o">(</span> <span class="n">it</span> <span class="o">!=</span> <span class="kc">null</span> <span class="o">)</span> <span class="o">{</span>
    <span class="n">it</span><span class="o">.</span><span class="na">dispose</span><span class="o">();</span>
  <span class="o">}</span>
  <span class="k">if</span><span class="o">(</span> <span class="n">set</span> <span class="o">!=</span> <span class="kc">null</span> <span class="o">)</span> <span class="o">{</span>
    <span class="n">set</span><span class="o">.</span><span class="na">dispose</span><span class="o">();</span>
  <span class="o">}</span>
<span class="o">}</span>
</pre></div>
</div>
<div class="admonition tip">
<p class="first admonition-title">Truco</p>
<p class="last">Puede encontrar información sobre los mecanismos
disponibles para el acceso a datos consultando la
<a class="reference external" href="http://docs.gvsig.org/plone/projects/gvsig-desktop/docs/devel/org.gvsig.fmap.dal/2.0.0">Guía para el desarrollador de la Librería de Acceso a Datos (DAL)</a></p>
</div>
<p>De aquí resaltar:</p>
<ul class="simple">
<li>Podemos averiguar qué atributo de la <em>feature</em> es el que contiene la geometría
a través del <em>getDefaultGeometryAttributeName</em> del <em>feature type</em> de nuestro <em>store</em>.</li>
<li>Para realizar una búsqueda de <em>features</em> en un <em>store</em> lo haremos invocando al método
<em>getFeatureSet</em> pasando como parámetro una instancia de <em>FeatureQuery</em> en la que se
especifiquen las condiciones de filtrado. En ella también se pueden especificar
orden o atributos que queremos recuperar en nuestra query.</li>
<li>La condición de filtro se especifica suministrando un Evaluator al método <em>setFilter</em>
de nuestra query.</li>
<li>Debemos encargarnos de liberar los objetos que creemos, como son <em>iteradores</em> o <em>feature sets</em>.
Hay que tener en cuenta que dependiendo del tipo de <em>store</em> con el que estemos trabajando
estos pueden tener reservados recursos como conexiones a BBDD, recordsets o conexiones a
servidores remotos.</li>
</ul>
</li>
<li><p class="first">El método <em>openShape</em>. Aquí podemos ver cómo abrir un <em>store</em> basado en shapes
ya existentes:</p>
<div class="highlight-java"><div class="highlight"><pre><span></span><span class="n">parameters</span> <span class="o">=</span> <span class="n">manager</span><span class="o">.</span><span class="na">createStoreParameters</span><span class="o">(</span><span class="s">&quot;Shape&quot;</span><span class="o">);</span>
<span class="n">parameters</span><span class="o">.</span><span class="na">setDynValue</span><span class="o">(</span><span class="s">&quot;shpfile&quot;</span><span class="o">,</span> <span class="n">shape</span><span class="o">);</span>
<span class="n">parameters</span><span class="o">.</span><span class="na">setDynValue</span><span class="o">(</span><span class="s">&quot;crs&quot;</span><span class="o">,</span> <span class="s">&quot;EPSG:23030&quot;</span><span class="o">);</span>
<span class="k">return</span> <span class="o">(</span><span class="n">FeatureStore</span><span class="o">)</span> <span class="n">manager</span><span class="o">.</span><span class="na">openStore</span><span class="o">(</span><span class="s">&quot;Shape&quot;</span><span class="o">,</span> <span class="n">parameters</span><span class="o">);</span>
</pre></div>
</div>
<p>Observaremos que para abrir un <em>store</em> lo realizaremos en dos fases. Por un lado crearemos
una estructura para albergar los parámetros necesarios para abrir nuestro <em>store</em>, la
inicializaremos con los valores adecuados e invocaremos al método <em>openStore</em> del manager
de acceso a datos con esos parámetros.</p>
<p>Cada tipo de <em>store</em> tendrá un juego de parámetros específicos de él. Para abrir un shape,
deberemos indicarle como mínimo el nombre del fichero y el sistema de referencia en el que
se encuentra.</p>
</li>
</ul>
</li>
<li><p class="first"><strong>IntersectsEvaluator</strong>. Se trata de la clase que evalúa la condición usada en el filtro.
Esta clase comprueba si el campo geometría especificado de una feature dada intersecta con
una geometría concreta. En su construcción se le suministran el campo que contiene la
geometría de la feature y la geometría con la que hay que comprobar si intersecta. De esta
clase conviene resaltar:</p>
<ul>
<li><p class="first">el método <em>evaluate</em>, encargado de realizar la comprobación:</p>
<div class="highlight-java"><div class="highlight"><pre><span></span><span class="n">Geometry</span> <span class="n">op1geom</span> <span class="o">=</span> <span class="o">(</span><span class="n">Geometry</span><span class="o">)</span> <span class="n">data</span><span class="o">.</span><span class="na">getDataValue</span><span class="o">(</span><span class="k">this</span><span class="o">.</span><span class="na">op2attrname</span><span class="o">);</span>
<span class="k">return</span> <span class="k">this</span><span class="o">.</span><span class="na">op1geom</span><span class="o">.</span><span class="na">intersects</span><span class="o">(</span><span class="n">op1geom</span><span class="o">);</span>
</pre></div>
</div>
<p>Sabiendo cómo se llama el atributo que contiene la geometría podemos obtener esta
a través del método <em>getDataValue</em>. Una vez tenemos las dos geometrías podemos
invocar el método <em>intersecs</em> de la geometría para comprobar si intersectan.</p>
</li>
<li><p class="first">El método <em>getCQL</em>. Este método devolverá una cadena siguiendo el formato de un <em>where</em> de
sql a utilizar como filtro en <em>stores</em> que ataquen a la BBDD sql. El filtro devuelto puede
no ser exactamente el mismo que el implementado por el código del método <em>evaluate</em>, actuando
a modo de filtro previo a este siempre que el store lo soporte.</p>
</li>
</ul>
</li>
<li><p class="first"><strong>DefaultLandregistryviewerBlock</strong>. Representa a una manzana de nuestro dominio. Almacena la
geometría que da forma a la manzana. La parte más relevante de esta clase es el
método <em>getProperties</em> que retorna todas las parcelas que se encuentran sobre
esa manzana:</p>
<div class="highlight-java"><div class="highlight"><pre><span></span><span class="n">List</span> <span class="n">properties</span> <span class="o">=</span> <span class="k">new</span> <span class="n">ArrayList</span><span class="o">();</span>

<span class="n">FeatureStore</span> <span class="n">store</span> <span class="o">=</span> <span class="k">this</span><span class="o">.</span><span class="na">manager</span><span class="o">.</span><span class="na">getProperties</span><span class="o">();</span>
<span class="n">String</span> <span class="n">attrGeomName</span> <span class="o">=</span> <span class="n">store</span><span class="o">.</span><span class="na">getDefaultFeatureType</span><span class="o">().</span><span class="na">getDefaultGeometryAttributeName</span><span class="o">();</span>
<span class="n">FeatureQuery</span> <span class="n">query</span> <span class="o">=</span> <span class="n">store</span><span class="o">.</span><span class="na">createFeatureQuery</span><span class="o">();</span>
<span class="n">query</span><span class="o">.</span><span class="na">setFilter</span><span class="o">(</span> <span class="k">new</span> <span class="n">IntersectsEvaluator</span><span class="o">(</span><span class="n">attrGeomName</span><span class="o">,</span> <span class="k">this</span><span class="o">.</span><span class="na">shape</span><span class="o">)</span> <span class="o">);</span>
<span class="n">set</span> <span class="o">=</span> <span class="k">this</span><span class="o">.</span><span class="na">manager</span><span class="o">.</span><span class="na">getProperties</span><span class="o">().</span><span class="na">getFeatureSet</span><span class="o">(</span><span class="n">query</span><span class="o">);</span>
<span class="k">if</span><span class="o">(</span> <span class="n">set</span><span class="o">.</span><span class="na">isEmpty</span><span class="o">()</span> <span class="o">)</span> <span class="o">{</span>
  <span class="k">return</span> <span class="kc">null</span><span class="o">;</span>
<span class="o">}</span>
<span class="n">it</span> <span class="o">=</span> <span class="n">set</span><span class="o">.</span><span class="na">fastiterator</span><span class="o">();</span>
<span class="k">while</span><span class="o">(</span> <span class="n">it</span><span class="o">.</span><span class="na">hasNext</span><span class="o">()</span> <span class="o">)</span> <span class="o">{</span>
  <span class="n">Feature</span> <span class="n">f</span> <span class="o">=</span> <span class="o">(</span><span class="n">Feature</span><span class="o">)</span> <span class="n">it</span><span class="o">.</span><span class="na">next</span><span class="o">();</span>
  <span class="n">LandregistryviewerProperty</span> <span class="n">property</span> <span class="o">=</span> <span class="k">new</span> <span class="n">DefaultLandregistryviewerProperty</span><span class="o">(</span>
    <span class="k">this</span><span class="o">.</span><span class="na">manager</span><span class="o">,</span>
    <span class="n">f</span><span class="o">.</span><span class="na">getString</span><span class="o">(</span><span class="n">PROPERTIES_CODE</span><span class="o">),</span>
    <span class="n">f</span><span class="o">.</span><span class="na">getGeometry</span><span class="o">(</span><span class="n">attrGeomName</span><span class="o">),</span>
    <span class="n">f</span><span class="o">.</span><span class="na">getInt</span><span class="o">(</span><span class="n">PROPERTIES_CREATIONDATE</span><span class="o">),</span>
    <span class="n">f</span><span class="o">.</span><span class="na">getInt</span><span class="o">(</span><span class="n">PROPERTIES_MUNICODE</span><span class="o">)</span>
  <span class="o">);</span>
  <span class="n">properties</span><span class="o">.</span><span class="na">add</span><span class="o">(</span><span class="n">property</span><span class="o">);</span>
<span class="o">}</span>
<span class="k">return</span> <span class="n">properties</span><span class="o">;</span>
</pre></div>
</div>
<p>Podemos observar que utiliza el mismo mecanismo para filtrar las parcelas que
usa el manager para recuperar un manzana. En este caso una vez a conseguido el <em>set</em>
con las parcelas, lo recorre, recuperando los datos de estas y creando los
objetos parcela.</p>
</li>
<li><p class="first"><strong>DefaultLandregistryviewerProperty</strong>. Se trata de la clase que representa a un parcela. En nuestro
ejemplo no tiene apenas lógica, limitándose a almacenar los datos y exponerlos mediante
<em>geters</em>.</p>
</li>
</ul>
</div>


          </div>
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
            <p class="logo"><a href="../../../index.html">
              <img class="logo" src="../../../_static/gvsig_asoc.jpg" alt="Logo"/>
            </a></p>
  <h4>Tema anterior</h4>
  <p class="topless"><a href="05_the_project_dependencies.html"
                        title="capítulo anterior">5. Las dependencias en los distintos proyectos</a></p>
  <h4>Próximo tema</h4>
  <p class="topless"><a href="07_the_library_containing_the_user_interface.html"
                        title="próximo capítulo">7. La librería con la presentación</a></p>
  <div role="note" aria-label="source link">
    <h3>Esta página</h3>
    <ul class="this-page-menu">
      <li><a href="../../../_sources/developers_quick_start/2.3/05_building_our_first_plugin/06_the_library_containing_the_logic.rst.txt"
            rel="nofollow">Mostrar el código</a></li>
    </ul>
   </div>
<div id="links"><h3>Links</h3><ul><li><ul style="list-style-type:square">
<li><a href="https://gist.github.com/search?utf8=%E2%9C%93&q=gvsig">Repositorio de Scripts</a></li>
<li><a href="http://downloads.gvsig.org/download/web/scriptcatalog/build/html/">Catálogo de Plugins</a></li></ul></li></ul>
</div>
<div id="searchbox" style="display: none" role="search">
  <h3>Búsqueda rápida</h3>
    <gcse:search></gcse:search>
    <p class="searchtip" style="font-size: 90%">
    </p>
</div>
<script>
  (function() {
    var cx = '009725233275570792772:egtqc4l6lsi';
    var gcse = document.createElement('script');
    gcse.type = 'text/javascript';
    gcse.async = true;
    gcse.src = 'https://cse.google.com/cse.js?cx=' + cx;
    var s = document.getElementsByTagName('script')[0];
    s.parentNode.insertBefore(gcse, s);
  })();
</script>

<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navegación</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../../../genindex.html" title="Índice General"
             >índice</a></li>
        <li class="right" >
          <a href="07_the_library_containing_the_user_interface.html" title="7. La librería con la presentación"
             >siguiente</a> |</li>
        <li class="right" >
          <a href="05_the_project_dependencies.html" title="5. Las dependencias en los distintos proyectos"
             >anterior</a> |</li>
        <li class="nav-item nav-item-0"><a href="../../../index.html">documentación de gvSIG Docs - 1.0.0</a> &#187;</li>
          <li class="nav-item nav-item-1"><a href="../index.html" >gvSIG 2.3.1. Guía de inicio rápido para el desarrollador</a> &#187;</li>
          <li class="nav-item nav-item-2"><a href="00_index.html" >Construyendo nuestro primer plugin</a> &#187;</li>

<div align="right">
<li>
<a href="http://downloads.gvsig.org/download/web/es/build/html/index.html"><img src="http://downloads.gvsig.org/download/web/pt_br/build/html/_static/flag_ES.png"></a></li>
<a href="http://downloads.gvsig.org/download/web/en/build/html/index.html"><img src="http://downloads.gvsig.org/download/web/pt_br/build/html/_static/flag_EN.png"></a></li>
<a href="http://downloads.gvsig.org/download/web/pt_br/build/html/index.html"><img src="http://downloads.gvsig.org/download/web/pt_br/build/html/_static/flag_BR.png"></a></li>
</div>

      </ul>
    </div>
    <div class="footer" role="contentinfo">
        &#169; Derechos de autor 2017, gvSIG association.
      Creado con <a href="http://sphinx-doc.org/">Sphinx</a> 1.6.3.
    </div>
  </body>
</html>